(()=>{"use strict";var e=function(e,t,i,n){return new(i||(i=Promise))((function(s,l){function r(e){try{o(n.next(e))}catch(e){l(e)}}function u(e){try{o(n.throw(e))}catch(e){l(e)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,u)}o((n=n.apply(e,t||[])).next())}))};function t(e,t,i,n=null,s=0,l=!0){let r=function(e,t){const i=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(i," attribute vec4 aVertexPosition;\n\nvoid main() {\n  gl_Position = aVertexPosition;\n}"),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))return i;console.log(e.getShaderInfoLog(i)),e.deleteShader(i)}(e),u=function(e,t){const i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,"precision mediump float;\nuniform vec4 vColor;\nuniform int point;\n\nvoid main() {\n\n  gl_FragColor = vColor;\n}\n\n"),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))return i;console.log(e.getShaderInfoLog(i)),e.deleteShader(i)}(e),o=function(e,t,i){let n=e.createProgram();if(e.attachShader(n,t),e.attachShader(n,i),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS))return n;console.log(e.getProgramInfoLog(n)),e.deleteProgram(n)}(e,r,u),a=e.getAttribLocation(o,"aVertexPosition"),h=e.getUniformLocation(o,"vColor"),c=e.getUniformLocation(o,"point"),f=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,f),i=function(e,t,i){let n=[];for(let t=0;t<e.length;t+=2){let s=2*Math.PI/12;for(let l=0;l<=2*Math.PI;l+=s)n=n.concat([e[t],e[t+1],Math.sin(l)*i+e[t],Math.cos(l)*i+e[t+1],Math.sin(l+s)*i+e[t],Math.cos(l+s)*i+e[t+1]])}return n}(i,0,.02);let p=t.concat(i),d=[],m=[];if(null!=n){let e=64;s>64&&(e=s*Math.PI/8);let t=2*Math.PI/e;for(let e=0;e<=2*Math.PI;e+=t){let i=Math.sin(e)*s+n.x,l=Math.cos(e)*s+n.y,r=Math.sin(e+t)*s+n.x,u=Math.cos(e+t)*s+n.y;d.push(i,l,r,u),m.push(n.x,n.y,i,l,r,u)}p=p.concat(d),p=p.concat(m)}e.bufferData(e.ARRAY_BUFFER,new Float32Array(p),e.STATIC_DRAW),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(.094,.094,.145,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(o),e.enableVertexAttribArray(a),e.bindBuffer(e.ARRAY_BUFFER,f);let g=e.FLOAT,y=0;if(e.vertexAttribPointer(a,2,g,!1,0,y),null!=n){l?e.uniform4f(h,.651,.89,.631,.33):e.uniform4f(h,.98,.702,.529,.33),e.uniform1i(c,1);let n=e.TRIANGLES;y=t.length/2+i.length/2+d.length/2;let s=m.length/2;console.log(s),e.drawArrays(n,y,s),l?e.uniform4f(h,.651,.89,.631,1):e.uniform4f(h,.98,.702,.529,1),e.uniform1i(c,1),n=e.LINES,y=t.length/2+i.length/2,s=d.length/2,console.log(s),e.drawArrays(n,y,s)}e.uniform4f(h,.537,.706,.98,1),e.uniform1i(c,1);let v=e.LINES;y=0;let b=t.length/2;console.log(b),e.drawArrays(v,y,b),e.uniform4f(h,.953,.545,.659,1),e.uniform1i(c,1),v=e.TRIANGLES,y=t.length/2,b=i.length/2,e.drawArrays(v,y,b)}class i{constructor(e,t,i){this.x=e,this.y=t,this.z=i}cmult(e){return new i(this.x*e,this.y*e,this.z*e)}add(e){return new i(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return this.add(e.cmult(-1))}equals(e){return this.x==e.x&&this.y==e.y&&this.z==e.z}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}cross(e){return new i(this.y*e.z-this.z*e.y,this.x*e.z-this.z*e.x,this.x*e.y-this.y*e.x)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}pair(){return[this.x,this.y]}}class n{constructor(e,t,i){this.p1=e,this.p2=t,this.p3=i}equals(e){return this.p1.equals(e.p1)&&this.p2.equals(e.p2)&&this.p3.equals(e.p3)||this.p1.equals(e.p1)&&this.p2.equals(e.p3)&&this.p3.equals(e.p2)||this.p1.equals(e.p2)&&this.p2.equals(e.p1)&&this.p3.equals(e.p3)||this.p1.equals(e.p2)&&this.p2.equals(e.p3)&&this.p3.equals(e.p1)||this.p1.equals(e.p3)&&this.p2.equals(e.p1)&&this.p3.equals(e.p2)||this.p1.equals(e.p3)&&this.p2.equals(e.p2)&&this.p3.equals(e.p1)}hasCommmonVertex(e){return this.p1.equals(e.p1)||this.p2.equals(e.p1)||this.p3.equals(e.p1)||this.p1.equals(e.p2)||this.p2.equals(e.p2)||this.p3.equals(e.p2)||this.p1.equals(e.p3)||this.p2.equals(e.p3)||this.p3.equals(e.p3)}getEdges(){return[[this.p1,this.p2],[this.p2,this.p3],[this.p3,this.p1]]}getCircumradius(){return this.p1.sub(this.p2).mag()*this.p2.sub(this.p3).mag()*this.p3.sub(this.p1).mag()/(2*this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag())}getCircumcenter(){let e=2*Math.pow(this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag(),2),t=Math.pow(this.p2.sub(this.p3).mag(),2)*this.p1.sub(this.p3).dot(this.p1.sub(this.p2))/e,i=Math.pow(this.p1.sub(this.p3).mag(),2)*this.p2.sub(this.p3).dot(this.p2.sub(this.p1))/e,n=Math.pow(this.p1.sub(this.p2).mag(),2)*this.p3.sub(this.p1).dot(this.p3.sub(this.p2))/e;return this.p1.cmult(t).add(this.p2.cmult(i)).add(this.p3.cmult(n))}inCircumscribe(e){return this.getCircumcenter().sub(e).mag()<this.getCircumradius()}hasEdge(e,t){return(this.p1.equals(e)||this.p2.equals(e)||this.p3.equals(e))&&(this.p1.equals(t)||this.p2.equals(t)||this.p3.equals(t))&&!e.equals(t)}}function s(e,t){for(let i=0;i<e.length;i++)if(e[i].equals(t))return i;return-1}function l(e){let t=[];for(let i of e)for(let e of i.getEdges())t.push(e[0].x,e[0].y,e[1].x,e[1].y);return t}function r(t,i,n=0){return e(this,void 0,void 0,(function*(){let e=document.getElementById(t);e.style.outline="solid",e.style.outlineWidth="4px",e.style.outlineColor="#96CDFB",yield u(i,n),e.style.outline="2px solid transparent",e.style.outlineOffset="2px"}))}function u(t,i=0){return e(this,void 0,void 0,(function*(){let e;t.addEventListener("click",(function(){e(0)})),document.addEventListener("cancelStep",(function(){e(0)})),document.addEventListener("playPause",(function(){e(0==i?0:1)}));let n=new Promise((t=>{0!=i&&setTimeout(t,i),e=t})),s=!1;yield n.then((e=>{s=1==e})),s&&(yield u(t))}))}function o(u,o,a=!1,h=!1,c=new HTMLElement,f=new HTMLInputElement){return e(this,void 0,void 0,(function*(){document.addEventListener("cancelStep",(function(){a=!1})),document.addEventListener("playPause",(function(){h=!h,console.log("PLAYING")}));let e=[],p=[];if(a){t(u,[],o);let e=0;if(h&&(e=1700-f.valueAsNumber,console.log("value: "+f.valueAsNumber)),yield r("line02",c,e),!a)return[]}if(o.length<2)return p;let d=o[0],m=d,g=o[1],y=g;for(let t=0;t<o.length;t+=2)o[t]<d&&(d=o[t]),o[t]>m&&(m=o[t]),o[t+1]<g&&(g=o[t+1]),o[t+1]>y&&(y=o[t+1]),e.push(new i(o[t],o[t+1],0));let v=new i(d-1e6,g-1e6,0),b=new i(m+1e6,g-1e6,0),A=new i(Math.floor((d+m)/2),y+1e6,0),E=new n(v,b,A);if(p.push(E),a){t(u,l(p),o);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line03",c,e),!a)return[]}let q=[];for(let i of e){if(q.push(i.x,i.y),a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line04",c,e),!a)return[]}let e=[];if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line05",c,e),!a)return[]}for(let n of p){if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line06",c,e),!a)return[]}let s=n.inCircumscribe(i);if(a){t(u,l(p),q,n.getCircumcenter(),n.getCircumradius(),!s);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line07",c,e),!a)return[]}if(s&&(e.push(n),a)){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line08",c,e),!a)return[]}}let o=[];if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line09",c,e),!a)return[]}for(let i of e){if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line10",c,e),!a)return[]}for(let n of i.getEdges()){if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line11",c,e),!a)return[]}let s=!1;for(let t of e)!i.equals(t)&&t.hasEdge(n[0],n[1])&&(s=!0);if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line12",c,e),!a)return[]}if(!s&&(o.push(n),a)){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line13",c,e),!a)return[]}}}for(let i of e){if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line14",c,e),!a)return[]}const e=s(p,i);if(e>-1?p.splice(e,1):console.log("Unable to remove triangle from array!"),a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line15",c,e),!a)return[]}}for(let e of o){if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line16",c,e),!a)return[]}if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line17",c,e),!a)return[]}if(p.push(new n(e[0],e[1],i)),a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line18",c,e),!a)return[]}}}let w=[],x=0;for(;x<p.length;){let e=p[x];if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line19",c,e),!a)return[]}if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line20",c,e),!a)return[]}if(e.hasCommmonVertex(E)){const i=s(p,e);if(i>-1?p.splice(i,1):console.log("Unable to remove triangle from array!"),a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line21",c,e),!a)return[]}}else{for(let t of e.getEdges())w.push(t[0].x,t[0].y,t[1].x,t[1].y);x++}}if(a){t(u,l(p),q);let e=0;if(h&&(e=1700-f.valueAsNumber),yield r("line22",c,e),!a)return[]}t(u,w,o)}))}function a(e,t){e.style.display="block",t.style.display="none"}!function(){const i=document.querySelector("canvas"),n=i.getContext("webgl",{premultipliedAlpha:!1});let s=[],l=[];t(n,s,l);const r=document.getElementById("triangulate"),u=document.getElementById("step"),h=document.getElementById("next"),c=document.getElementById("clear"),f=document.getElementById("play"),p=document.getElementById("pause"),d=document.getElementById("speedSlider");let m=!1,g=new Event("cancelStep"),y=new Event("playPause");i.onmousedown=function(e){m=!1,document.dispatchEvent(g),console.log("offsetX:"+e.offsetX),console.log("offsetY:"+e.offsetY),i.width=i.clientWidth,i.height=i.clientHeight;let r=(-i.width/2+e.offsetX)/(i.width/2),u=(i.height/2-e.offsetY)/(i.height/2);console.log("X: "+r),console.log("Y: "+u),l=l.concat([r,u]),t(n,s,l)},r.addEventListener("click",(function(){m=!1,document.dispatchEvent(g),o(n,l,!1,!1,h,d),a(u,h),a(f,p)})),u.addEventListener("click",(function(){return e(this,void 0,void 0,(function*(){m=!0,a(h,u),yield o(n,l,!0,!1,h,d),a(u,h),a(f,p),m=!1}))})),c.addEventListener("click",(function(){m=!1,document.dispatchEvent(g),s=[],l=[],t(n,s,l),a(u,h),a(f,p)})),f.addEventListener("click",(function(){return e(this,void 0,void 0,(function*(){m?(document.dispatchEvent(y),a(p,f)):(m=!0,a(h,u),a(p,f),yield o(n,l,!0,!0,h,d),a(u,h),a(f,p),m=!1)}))})),p.addEventListener("click",(function(){a(f,p),document.dispatchEvent(y)}))}()})();