(()=>{"use strict";var t=function(t,e,s,i){return new(s||(s=Promise))((function(n,o){function r(t){try{h(i.next(t))}catch(t){o(t)}}function a(t){try{h(i.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,a)}h((i=i.apply(t,e||[])).next())}))};function e(t,e,s){let i=function(t,e){const s=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(s," attribute vec4 aVertexPosition;\n\nvoid main() {\n  gl_Position = aVertexPosition;\n}"),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS))return s;console.log(t.getShaderInfoLog(s)),t.deleteShader(s)}(t),n=function(t,e){const s=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(s,"precision mediump float;\nuniform vec4 vColor;\nuniform int point;\n\nvoid main() {\n\n  gl_FragColor = vColor;\n}\n\n"),t.compileShader(s),t.getShaderParameter(s,t.COMPILE_STATUS))return s;console.log(t.getShaderInfoLog(s)),t.deleteShader(s)}(t),o=function(t,e,s){let i=t.createProgram();if(t.attachShader(i,e),t.attachShader(i,s),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS))return i;console.log(t.getProgramInfoLog(i)),t.deleteProgram(i)}(t,i,n),r=t.getAttribLocation(o,"aVertexPosition"),a=t.getUniformLocation(o,"vColor"),h=t.getUniformLocation(o,"point"),l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),s=function(t,e,s){let i=[];for(let e=0;e<t.length;e+=2){let n=2*Math.PI/12;for(let o=0;o<=2*Math.PI;o+=n)i=i.concat([t[e],t[e+1],Math.sin(o)*s+t[e],Math.cos(o)*s+t[e+1],Math.sin(o+n)*s+t[e],Math.cos(o+n)*s+t[e+1]])}return i}(s,0,.02);let u=e.concat(s);t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(.094,.094,.145,1),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(o),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,l);let p=t.FLOAT,c=0;t.vertexAttribPointer(r,2,p,!1,0,c),t.uniform4f(a,.537,.706,.98,1),t.uniform1i(h,1);let f=t.LINES;c=0;let d=e.length/2;console.log(d),t.drawArrays(f,c,d),t.uniform4f(a,.953,.545,.659,1),t.uniform1i(h,1),f=t.TRIANGLES,c=e.length/2,d=s.length/2,t.drawArrays(f,c,d)}class s{constructor(t,e,s){this.x=t,this.y=e,this.z=s}cmult(t){return new s(this.x*t,this.y*t,this.z*t)}add(t){return new s(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return this.add(t.cmult(-1))}equals(t){return this.x==t.x&&this.y==t.y&&this.z==t.z}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}cross(t){return new s(this.y*t.z-this.z*t.y,this.x*t.z-this.z*t.x,this.x*t.y-this.y*t.x)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}pair(){return[this.x,this.y]}}class i{constructor(t,e,s){this.p1=t,this.p2=e,this.p3=s}equals(t){return this.p1.equals(t.p1)&&this.p2.equals(t.p2)&&this.p3.equals(t.p3)||this.p1.equals(t.p1)&&this.p2.equals(t.p3)&&this.p3.equals(t.p2)||this.p1.equals(t.p2)&&this.p2.equals(t.p1)&&this.p3.equals(t.p3)||this.p1.equals(t.p2)&&this.p2.equals(t.p3)&&this.p3.equals(t.p1)||this.p1.equals(t.p3)&&this.p2.equals(t.p1)&&this.p3.equals(t.p2)||this.p1.equals(t.p3)&&this.p2.equals(t.p2)&&this.p3.equals(t.p1)}hasCommmonVertex(t){return this.p1.equals(t.p1)||this.p2.equals(t.p1)||this.p3.equals(t.p1)||this.p1.equals(t.p2)||this.p2.equals(t.p2)||this.p3.equals(t.p2)||this.p1.equals(t.p3)||this.p2.equals(t.p3)||this.p3.equals(t.p3)}getEdges(){return[[this.p1,this.p2],[this.p2,this.p3],[this.p3,this.p1]]}getCircumradius(){return this.p1.sub(this.p2).mag()*this.p2.sub(this.p3).mag()*this.p3.sub(this.p1).mag()/(2*this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag())}getCircumcenter(){let t=2*Math.pow(this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag(),2),e=Math.pow(this.p2.sub(this.p3).mag(),2)*this.p1.sub(this.p3).dot(this.p1.sub(this.p2))/t,s=Math.pow(this.p1.sub(this.p3).mag(),2)*this.p2.sub(this.p3).dot(this.p2.sub(this.p1))/t,i=Math.pow(this.p1.sub(this.p2).mag(),2)*this.p3.sub(this.p1).dot(this.p3.sub(this.p2))/t;return this.p1.cmult(e).add(this.p2.cmult(s)).add(this.p3.cmult(i))}inCircumscribe(t){return this.getCircumcenter().sub(t).mag()<this.getCircumradius()}hasEdge(t,e){return(this.p1.equals(t)||this.p2.equals(t)||this.p3.equals(t))&&(this.p1.equals(e)||this.p2.equals(e)||this.p3.equals(e))&&!t.equals(e)}}function n(t,e){for(let s=0;s<t.length;s++)if(t[s].equals(e))return s;return-1}function o(o,r,a=!1,h=new HTMLElement){return t(this,void 0,void 0,(function*(){let l=[],u=[];if(r.length<2)return u;let p=r[0],c=p,f=r[1],d=f;for(let t=0;t<r.length;t+=2)r[t]<p&&(p=r[t]),r[t]>c&&(c=r[t]),r[t+1]<f&&(f=r[t+1]),r[t+1]>d&&(d=r[t+1]),l.push(new s(r[t],r[t+1],0));let g=new s(p-1e6,f-1e6,0),m=new s(c+1e6,f-1e6,0),q=new s(Math.floor((p+c)/2),d+1e6,0),y=new i(g,m,q);u.push(y),y.getCircumcenter(),y.getCircumradius(),a&&(e(o,[],r),function(e){t(this,void 0,void 0,(function*(){let t;e.addEventListener("click",(function(){t(0)}));let s=new Promise((e=>{t=e}));yield s}))}(h));for(let t of l){let e=[];for(let s of u)s.inCircumscribe(t)&&e.push(s);let s=[];for(let t of e)for(let i of t.getEdges()){let n=!1;for(let s of e)!t.equals(s)&&s.hasEdge(i[0],i[1])&&(n=!0);n||s.push(i)}for(let t of e){const e=n(u,t);e>-1?u.splice(e,1):console.log("Unable to remove triangle from array!")}for(let e of s)u.push(new i(e[0],e[1],t))}let b=[],w=0;for(;w<u.length;){let t=u[w];if(t.hasCommmonVertex(y)){const e=n(u,t);e>-1?u.splice(e,1):console.log("Unable to remove triangle from array!")}else{for(let e of t.getEdges())b.push(e[0].x,e[0].y,e[1].x,e[1].y);w++}}e(o,b,r)}))}function r(t,e){t.style.display="block",e.style.display="none"}!function(){const s=document.querySelector("canvas"),i=s.getContext("webgl");let n=[],a=[];e(i,n,a);const h=document.getElementById("triangulate"),l=document.getElementById("step"),u=document.getElementById("next"),p=document.getElementById("clear");s.onmousedown=function(t){console.log("offsetX:"+t.offsetX),console.log("offsetY:"+t.offsetY);let o=(-s.width/2+t.offsetX)/(s.width/2),r=(s.height/2-t.offsetY)/(s.height/2);console.log("X: "+o),console.log("Y: "+r),a=a.concat([o,r]),e(i,n,a)},h.addEventListener("click",(function(){o(i,a),r(l,u)})),l.addEventListener("click",(function(){return t(this,void 0,void 0,(function*(){var t;t=u,l.style.display="none",t.style.display="block",yield o(i,a,!0,u),r(l,u)}))})),p.addEventListener("click",(function(){n=[],a=[],e(i,n,a),r(l,u)}))}()})();