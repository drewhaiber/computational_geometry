(()=>{"use strict";var t=function(t,e,i,s){return new(i||(i=Promise))((function(n,l){function o(t){try{h(s.next(t))}catch(t){l(t)}}function r(t){try{h(s.throw(t))}catch(t){l(t)}}function h(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,r)}h((s=s.apply(t,e||[])).next())}))};function e(t,e,i){let s=function(t,e){const i=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(i," attribute vec4 aVertexPosition;\n\nvoid main() {\n  gl_Position = aVertexPosition;\n}"),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.log(t.getShaderInfoLog(i)),t.deleteShader(i)}(t),n=function(t,e){const i=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(i,"precision mediump float;\nuniform vec4 vColor;\nuniform int point;\n\nvoid main() {\n\n  gl_FragColor = vColor;\n}\n\n"),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.log(t.getShaderInfoLog(i)),t.deleteShader(i)}(t),l=function(t,e,i){let s=t.createProgram();if(t.attachShader(s,e),t.attachShader(s,i),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS))return s;console.log(t.getProgramInfoLog(s)),t.deleteProgram(s)}(t,s,n),o=t.getAttribLocation(l,"aVertexPosition"),r=t.getUniformLocation(l,"vColor"),h=t.getUniformLocation(l,"point"),a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),i=function(t,e,i){let s=[];for(let e=0;e<t.length;e+=2){let n=2*Math.PI/12;for(let l=0;l<=2*Math.PI;l+=n)s=s.concat([t[e],t[e+1],Math.sin(l)*i+t[e],Math.cos(l)*i+t[e+1],Math.sin(l+n)*i+t[e],Math.cos(l+n)*i+t[e+1]])}return s}(i,0,.02);let u=e.concat(i);t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(.094,.094,.145,1),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(l),t.enableVertexAttribArray(o),t.bindBuffer(t.ARRAY_BUFFER,a);let p=t.FLOAT,c=0;t.vertexAttribPointer(o,2,p,!1,0,c),t.uniform4f(r,.537,.706,.98,1),t.uniform1i(h,1);let d=t.LINES;c=0;let f=e.length/2;console.log(f),t.drawArrays(d,c,f),t.uniform4f(r,.953,.545,.659,1),t.uniform1i(h,1),d=t.TRIANGLES,c=e.length/2,f=i.length/2,t.drawArrays(d,c,f)}class i{constructor(t,e,i){this.x=t,this.y=e,this.z=i}cmult(t){return new i(this.x*t,this.y*t,this.z*t)}add(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return this.add(t.cmult(-1))}equals(t){return this.x==t.x&&this.y==t.y&&this.z==t.z}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}cross(t){return new i(this.y*t.z-this.z*t.y,this.x*t.z-this.z*t.x,this.x*t.y-this.y*t.x)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}pair(){return[this.x,this.y]}}class s{constructor(t,e,i){this.p1=t,this.p2=e,this.p3=i}equals(t){return this.p1.equals(t.p1)&&this.p2.equals(t.p2)&&this.p3.equals(t.p3)||this.p1.equals(t.p1)&&this.p2.equals(t.p3)&&this.p3.equals(t.p2)||this.p1.equals(t.p2)&&this.p2.equals(t.p1)&&this.p3.equals(t.p3)||this.p1.equals(t.p2)&&this.p2.equals(t.p3)&&this.p3.equals(t.p1)||this.p1.equals(t.p3)&&this.p2.equals(t.p1)&&this.p3.equals(t.p2)||this.p1.equals(t.p3)&&this.p2.equals(t.p2)&&this.p3.equals(t.p1)}hasCommmonVertex(t){return this.p1.equals(t.p1)||this.p2.equals(t.p1)||this.p3.equals(t.p1)||this.p1.equals(t.p2)||this.p2.equals(t.p2)||this.p3.equals(t.p2)||this.p1.equals(t.p3)||this.p2.equals(t.p3)||this.p3.equals(t.p3)}getEdges(){return[[this.p1,this.p2],[this.p2,this.p3],[this.p3,this.p1]]}getCircumradius(){return this.p1.sub(this.p2).mag()*this.p2.sub(this.p3).mag()*this.p3.sub(this.p1).mag()/(2*this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag())}getCircumcenter(){let t=2*Math.pow(this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag(),2),e=Math.pow(this.p2.sub(this.p3).mag(),2)*this.p1.sub(this.p3).dot(this.p1.sub(this.p2))/t,i=Math.pow(this.p1.sub(this.p3).mag(),2)*this.p2.sub(this.p3).dot(this.p2.sub(this.p1))/t,s=Math.pow(this.p1.sub(this.p2).mag(),2)*this.p3.sub(this.p1).dot(this.p3.sub(this.p2))/t;return this.p1.cmult(e).add(this.p2.cmult(i)).add(this.p3.cmult(s))}inCircumscribe(t){return this.getCircumcenter().sub(t).mag()<this.getCircumradius()}hasEdge(t,e){return(this.p1.equals(t)||this.p2.equals(t)||this.p3.equals(t))&&(this.p1.equals(e)||this.p2.equals(e)||this.p3.equals(e))&&!t.equals(e)}}function n(t,e){for(let i=0;i<t.length;i++)if(t[i].equals(e))return i;return-1}function l(e,i){return t(this,void 0,void 0,(function*(){let s=document.getElementById(e);s.style.outline="solid",s.style.outlineWidth="4px",s.style.outlineColor="#96CDFB",yield function(e){return t(this,void 0,void 0,(function*(){let t;e.addEventListener("click",(function(){t(0)}));let i=new Promise((e=>{t=e}));yield i}))}(i),s.style.outline="2px solid transparent",s.style.outlineOffset="2px"}))}function o(o,r,h=!1,a=new HTMLElement){return t(this,void 0,void 0,(function*(){let t=[],u=[];if(h&&(e(o,[],r),yield l("line02",a)),r.length<2)return u;let p=r[0],c=p,d=r[1],f=d;for(let e=0;e<r.length;e+=2)r[e]<p&&(p=r[e]),r[e]>c&&(c=r[e]),r[e+1]<d&&(d=r[e+1]),r[e+1]>f&&(f=r[e+1]),t.push(new i(r[e],r[e+1],0));let g=new i(p-1e6,d-1e6,0),m=new i(c+1e6,d-1e6,0),y=new i(Math.floor((p+c)/2),f+1e6,0),q=new s(g,m,y);u.push(q),h&&(e(o,[],r),yield l("line03",a));for(let i of t){h&&(e(o,[],r),yield l("line04",a));let t=[];h&&(e(o,[],r),yield l("line05",a));for(let s of u)h&&(e(o,[],r),yield l("line06",a)),h&&(e(o,[],r),yield l("line07",a)),s.inCircumscribe(i)&&(t.push(s),h&&(e(o,[],r),yield l("line08",a)));let p=[];h&&(e(o,[],r),yield l("line09",a));for(let i of t){h&&(e(o,[],r),yield l("line10",a));for(let s of i.getEdges()){h&&(e(o,[],r),yield l("line11",a));let n=!1;for(let e of t)!i.equals(e)&&e.hasEdge(s[0],s[1])&&(n=!0);h&&(e(o,[],r),yield l("line12",a)),n||(p.push(s),h&&(e(o,[],r),yield l("line13",a)))}}for(let i of t){h&&(e(o,[],r),yield l("line14",a));const t=n(u,i);t>-1?u.splice(t,1):console.log("Unable to remove triangle from array!"),h&&(e(o,[],r),yield l("line15",a))}for(let t of p)h&&(e(o,[],r),yield l("line16",a)),h&&(e(o,[],r),yield l("line17",a)),u.push(new s(t[0],t[1],i)),h&&(e(o,[],r),yield l("line18",a))}let b=[],v=0;for(;v<u.length;){let t=u[v];if(h&&(e(o,[],r),yield l("line19",a)),h&&(e(o,[],r),yield l("line20",a)),t.hasCommmonVertex(q)){const i=n(u,t);i>-1?u.splice(i,1):console.log("Unable to remove triangle from array!"),h&&(e(o,[],r),yield l("line21",a))}else{for(let e of t.getEdges())b.push(e[0].x,e[0].y,e[1].x,e[1].y);v++}}h&&(e(o,[],r),yield l("line22",a)),e(o,b,r)}))}function r(t,e){t.style.display="block",e.style.display="none"}!function(){const i=document.querySelector("canvas"),s=i.getContext("webgl");let n=[],l=[];e(s,n,l);const h=document.getElementById("triangulate"),a=document.getElementById("step"),u=document.getElementById("next"),p=document.getElementById("clear");i.onmousedown=function(t){console.log("offsetX:"+t.offsetX),console.log("offsetY:"+t.offsetY);let o=(-i.width/2+t.offsetX)/(i.width/2),r=(i.height/2-t.offsetY)/(i.height/2);console.log("X: "+o),console.log("Y: "+r),l=l.concat([o,r]),e(s,n,l)},h.addEventListener("click",(function(){o(s,l),r(a,u)})),a.addEventListener("click",(function(){return t(this,void 0,void 0,(function*(){var t;t=u,a.style.display="none",t.style.display="block",yield o(s,l,!0,u),r(a,u)}))})),p.addEventListener("click",(function(){n=[],l=[],e(s,n,l),r(a,u)}))}()})();