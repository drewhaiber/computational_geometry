(()=>{"use strict";function t(t,e,r){var s=function(t,e){var r=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(r," attribute vec4 aVertexPosition;\r\n\r\nvoid main() {\r\n  gl_Position = aVertexPosition;\r\n}"),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.log(t.getShaderInfoLog(r)),t.deleteShader(r)}(t),i=function(t,e){var r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,"precision mediump float;\r\nuniform vec4 vColor;\r\nuniform int point;\r\n\r\nvoid main() {\r\n\r\n  gl_FragColor = vColor;\r\n}\r\n\r\n"),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))return r;console.log(t.getShaderInfoLog(r)),t.deleteShader(r)}(t),o=function(t,e,r){var s=t.createProgram();if(t.attachShader(s,e),t.attachShader(s,r),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS))return s;console.log(t.getProgramInfoLog(s)),t.deleteProgram(s)}(t,s,i),n=t.getAttribLocation(o,"aVertexPosition"),a=t.getUniformLocation(o,"vColor"),h=t.getUniformLocation(o,"point"),p=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,p),r=function(t,e,r){for(var s=[],i=0;i<t.length;i+=2)for(var o=2*Math.PI/12,n=0;n<=2*Math.PI;n+=o)s=s.concat([t[i],t[i+1],Math.sin(n)*r+t[i],Math.cos(n)*r+t[i+1],Math.sin(n+o)*r+t[i],Math.cos(n+o)*r+t[i+1]]);return s}(r,0,.02);var u=e.concat(r);t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(.094,.094,.145,1),t.clear(t.COLOR_BUFFER_BIT),t.useProgram(o),t.enableVertexAttribArray(n),t.bindBuffer(t.ARRAY_BUFFER,p);var l=t.FLOAT,c=0;t.vertexAttribPointer(n,2,l,!1,0,c),t.uniform4f(a,.537,.706,.98,1),t.uniform1i(h,1);var f=t.LINES;c=0;var g=e.length/2;console.log(g),t.drawArrays(f,c,g),t.uniform4f(a,.953,.545,.659,1),t.uniform1i(h,1),f=t.TRIANGLES,c=e.length/2,g=r.length/2,t.drawArrays(f,c,g)}var e=function(){function t(t,e,r){this.x=t,this.y=e,this.z=r}return t.prototype.cmult=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.sub=function(t){return this.add(t.cmult(-1))},t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z},t.prototype.mag=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))},t.prototype.crossMag=function(t){return Math.abs(this.x*t.y-this.y*t.x)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.x*e.z-this.z*e.x,this.x*e.y-this.y*e.x)},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t.prototype.pair=function(){return[this.x,this.y]},t}(),r=function(){function t(t,e,r){this.p1=t,this.p2=e,this.p3=r}return t.prototype.equals=function(t){return this.p1.equals(t.p1)&&this.p2.equals(t.p2)&&this.p3.equals(t.p3)||this.p1.equals(t.p1)&&this.p2.equals(t.p3)&&this.p3.equals(t.p2)||this.p1.equals(t.p2)&&this.p2.equals(t.p1)&&this.p3.equals(t.p3)||this.p1.equals(t.p2)&&this.p2.equals(t.p3)&&this.p3.equals(t.p1)||this.p1.equals(t.p3)&&this.p2.equals(t.p1)&&this.p3.equals(t.p2)||this.p1.equals(t.p3)&&this.p2.equals(t.p2)&&this.p3.equals(t.p1)},t.prototype.hasCommmonVertex=function(t){return this.p1.equals(t.p1)||this.p2.equals(t.p1)||this.p3.equals(t.p1)||this.p1.equals(t.p2)||this.p2.equals(t.p2)||this.p3.equals(t.p2)||this.p1.equals(t.p3)||this.p2.equals(t.p3)||this.p3.equals(t.p3)},t.prototype.getEdges=function(){return[[this.p1,this.p2],[this.p2,this.p3],[this.p3,this.p1]]},t.prototype.getCircumradius=function(){return this.p1.sub(this.p2).mag()*this.p2.sub(this.p3).mag()*this.p3.sub(this.p1).mag()/(2*this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag())},t.prototype.getCircumcenter=function(){var t=2*Math.pow(this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag(),2),e=Math.pow(this.p2.sub(this.p3).mag(),2)*this.p1.sub(this.p3).dot(this.p1.sub(this.p2))/t,r=Math.pow(this.p1.sub(this.p3).mag(),2)*this.p2.sub(this.p3).dot(this.p2.sub(this.p1))/t,s=Math.pow(this.p1.sub(this.p2).mag(),2)*this.p3.sub(this.p1).dot(this.p3.sub(this.p2))/t;return this.p1.cmult(e).add(this.p2.cmult(r)).add(this.p3.cmult(s))},t.prototype.inCircumscribe=function(t){return this.getCircumcenter().sub(t).mag()<this.getCircumradius()},t.prototype.hasEdge=function(t,e){return(this.p1.equals(t)||this.p2.equals(t)||this.p3.equals(t))&&(this.p1.equals(e)||this.p2.equals(e)||this.p3.equals(e))&&!t.equals(e)},t}();function s(t,e){for(var r=0;r<t.length;r++)if(t[r].equals(e))return r;return-1}!function(){var i=document.querySelector("canvas"),o=i.getContext("webgl"),n=[],a=[];t(o,n,a);var h=document.getElementById("triangulate"),p=document.getElementById("clear");i.onmousedown=function(e){console.log("offsetX:"+e.offsetX),console.log("offsetY:"+e.offsetY);var r=(-i.width/2+e.offsetX)/(i.width/2),s=(i.height/2-e.offsetY)/(i.height/2);console.log("X: "+r),console.log("Y: "+s),a=a.concat([r,s]),t(o,n,a)},h.addEventListener("click",(function(){!function(i,o,n){void 0===n&&(n=!1);var a=[],h=[];if(o.length<2)return h;for(var p=o[0],u=p,l=o[1],c=l,f=0;f<o.length;f+=2)o[f]<p&&(p=o[f]),o[f]>u&&(u=o[f]),o[f+1]<l&&(l=o[f+1]),o[f+1]>c&&(c=o[f+1]),a.push(new e(o[f],o[f+1],0));var g=new e(p-1e6,l-1e6,0),m=new e(u+1e6,l-1e6,0),d=new e(Math.floor((p+u)/2),c+1e6,0),v=new r(g,m,d);h.push(v),v.getCircumcenter(),v.getCircumradius();for(var y=0,q=a;y<q.length;y++){for(var b=q[y],x=[],S=0,w=h;S<w.length;S++)(D=w[S]).inCircumscribe(b)&&x.push(D);for(var A=[],E=0,C=x;E<C.length;E++)for(var M=C[E],P=0,R=M.getEdges();P<R.length;P++){for(var L=R[P],I=!1,z=0,T=x;z<T.length;z++){var _=T[z];!M.equals(_)&&_.hasEdge(L[0],L[1])&&(I=!0)}I||A.push(L)}for(var F=0,U=x;F<U.length;F++)(N=s(h,D=U[F]))>-1?h.splice(N,1):console.log("Unable to remove triangle from array!");for(var B=0,V=A;B<V.length;B++){var Y=V[B];h.push(new r(Y[0],Y[1],b))}}for(var O=[],X=0;X<h.length;){var D;if((D=h[X]).hasCommmonVertex(v)){var N;(N=s(h,D))>-1?h.splice(N,1):console.log("Unable to remove triangle from array!")}else{for(var k=0,G=D.getEdges();k<G.length;k++)Y=G[k],O.push(Y[0].x,Y[0].y,Y[1].x,Y[1].y);X++}}t(i,O,o)}(o,a)})),p.addEventListener("click",(function(){t(o,n=[],a=[])}))}()})();